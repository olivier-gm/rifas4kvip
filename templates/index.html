<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/static/img/ico.png" type="image/x-icon">
    <title>Rifas 4K</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f0f0f;
            color: #e9ecef;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px 14px 100px;
        }

        /* ‚îÄ‚îÄ Logo ‚îÄ‚îÄ */
        .logo-wrap {
            margin: 10px 0 22px;
            display: flex;
            justify-content: center;
        }

        .logo-wrap img {
            width: 130px;
            height: 130px;
            object-fit: contain;
            filter: drop-shadow(0 0 12px rgba(76, 175, 80, 0.3));
        }

        @media (max-width: 600px) {
            .logo-wrap img {
                width: 85px;
                height: 85px;
            }
        }

        /* ‚îÄ‚îÄ T√≠tulo de secci√≥n de tabla ‚îÄ‚îÄ */
        .section-title {
            font-size: 0.68rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: #6c757d;
            margin-bottom: 8px;
            width: 100%;
            max-width: 340px;
            text-align: left;
        }

        /* ‚îÄ‚îÄ Tabla top compradores ‚îÄ‚îÄ */
        .table-wrap {
            width: 100%;
            max-width: 340px;
            margin-bottom: 22px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-family: inherit;
        }

        .table thead th {
            background-color: #212529;
            color: #fff;
            font-size: 0.72rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #454d55;
            padding: 11px 12px;
            text-align: center;
        }

        .table tbody td {
            color: #ced4da;
            padding: 11px 12px;
            border: none;
            border-top: 1px solid #2a2e32;
            font-size: 0.875rem;
            background-color: #181c20;
            text-align: center;
        }

        .table tbody tr:hover td {
            background-color: #1e2328;
        }

        .table tbody tr:first-child td {
            border-top: none;
        }

        .clickable-cell {
            cursor: pointer;
        }

        /* ‚îÄ‚îÄ Card de rifa ‚îÄ‚îÄ */
        .rifa-card {
            width: 100%;
            max-width: 340px;
            background-color: #161616;
            border: 1px solid #2a2a2a;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
            margin-bottom: 28px;
        }

        /* Imagen */
        .rifa-card .card-img {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover;
        }

        /* Cuerpo de la card */
        .card-body {
            padding: 16px 16px 18px;
        }

        /* Premio */
        .prize-label {
            font-size: 1rem;
            font-weight: 800;
            color: #fff;
            text-align: center;
            margin-bottom: 16px;
            line-height: 1.3;
        }

        /* Botones */
        .btn-buy {
            display: block;
            width: 100%;
            padding: 13px;
            font-size: 0.95rem;
            font-weight: 700;
            letter-spacing: 0.3px;
            text-align: center;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #1565c0, #1976d2);
            color: #fff;
            box-shadow: 0 4px 14px rgba(21, 101, 192, 0.4);
        }

        .btn-buy:hover:not([style*="display: none"]) {
            background: linear-gradient(90deg, #0d47a1, #1565c0);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(21, 101, 192, 0.55);
        }

        .btn-verify {
            display: block;
            width: 100%;
            padding: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            border: 1px solid #333;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #1a1a1a;
            color: #ced4da;
        }

        .btn-verify:hover {
            background-color: #212121;
            border-color: #555;
            transform: translateY(-1px);
        }

        /* Info row (fecha + barra) */
        .card-info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            margin-top: 14px;
        }

        .date-badge {
            background-color: #d32f2f;
            color: #fff;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.78rem;
            font-weight: 700;
            white-space: nowrap;
            flex-shrink: 0;
        }

        /* Barra de progreso */
        .progress-container {
            flex: 1;
            background-color: #2a2a2a;
            border-radius: 6px;
            overflow: hidden;
            height: 32px;
            position: relative;
        }

        .progress-bar {
            background-color: #4caf50;
            height: 100%;
            width: 0;
            transition: width 0.5s ease;
            border-radius: 6px;
            position: relative;
        }

        #progress-text,
        #progress-text-2 {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.72rem;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            pointer-events: none;
            white-space: nowrap;
        }

        /* ‚îÄ‚îÄ Separador entre rifas ‚îÄ‚îÄ */
        .rifa-divider {
            width: 100%;
            max-width: 340px;
            border: none;
            border-top: 1px solid #222;
            margin: 4px 0 22px;
        }

        /* ‚îÄ‚îÄ Bot√≥n Tickets Premiados ‚îÄ‚îÄ */
        .btn-premios {
            display: block;
            width: 100%;
            padding: 11px;
            font-size: 0.88rem;
            font-weight: 700;
            text-align: center;
            border: 1px solid #4caf50;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: transparent;
            color: #4caf50;
            margin-bottom: 8px;
        }

        .btn-premios:hover {
            background-color: rgba(76, 175, 80, 0.1);
            transform: translateY(-1px);
        }

        /* ‚îÄ‚îÄ Modal Premios ‚îÄ‚îÄ */
        .premios-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.88);
            z-index: 9998;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }

        .premios-modal.open {
            display: flex;
        }

        .premios-modal-content {
            background: #161616;
            border: 1px solid #2a2a2a;
            color: #ced4da;
            padding: 22px 18px;
            border-radius: 14px;
            max-width: 420px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .premios-modal-content h2 {
            font-size: 1rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 16px;
            text-align: center;
        }

        .pm-row {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 9px 12px;
            border-radius: 8px;
            background: #212529;
            border: 1px solid #2a2e32;
            margin-bottom: 6px;
        }

        .pm-num {
            font-family: monospace;
            font-weight: 700;
            color: #4caf50;
            min-width: 52px;
        }

        .pm-val {
            flex: 1;
            font-size: .88rem;
        }

        .pm-stat {
            font-size: .75rem;
            white-space: nowrap;
        }

        .pm-libre {
            color: #6c757d;
        }

        .pm-tomado {
            color: #ef9a9a;
        }

        .premios-close {
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 22px;
            cursor: pointer;
            color: #6c757d;
            line-height: 1;
        }

        .premios-close:hover {
            color: #fff;
        }

        /* ‚îÄ‚îÄ Bot√≥n WhatsApp ‚îÄ‚îÄ */
        .whatsapp {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #25d366;
            border-radius: 50%;
            width: 52px;
            height: 52px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 16px rgba(37, 211, 102, 0.4);
            transition: transform 0.2s;
            z-index: 900;
        }

        .whatsapp:hover {
            transform: scale(1.1);
        }

        .whatsapp img {
            width: 30px;
            height: auto;
        }

        /* ‚îÄ‚îÄ Bot√≥n T√©rminos ‚îÄ‚îÄ */
        .terms-button {
            position: fixed;
            bottom: 82px;
            left: 15px;
            background-color: #212529;
            color: #adb5bd;
            border: 1px solid #373b3e;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            font-family: inherit;
            z-index: 9999;
            line-height: 1.3;
            text-align: center;
            transition: background-color 0.2s;
        }

        .terms-button:hover {
            background-color: #2c3036;
            color: #fff;
        }

        /* ‚îÄ‚îÄ Modal de T√©rminos ‚îÄ‚îÄ */
        .terms-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.92);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }

        .terms-modal-content {
            background: #161616;
            border: 1px solid #2a2a2a;
            color: #ced4da;
            padding: 24px 22px;
            border-radius: 14px;
            max-width: 640px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            font-size: 0.88rem;
            line-height: 1.6;
            position: relative;
        }

        .terms-modal-content h2 {
            font-size: 1.05rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 16px;
            text-align: center;
        }

        .terms-modal-content p {
            margin-bottom: 8px;
        }

        .terms-close {
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 22px;
            cursor: pointer;
            color: #6c757d;
            transition: color 0.15s;
            line-height: 1;
        }

        .terms-close:hover {
            color: #fff;
        }
    </style>
</head>

<body>
    <!-- Script Top 5 (sin cambios de l√≥gica) -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            function aplicarTop5(tableElement) {
                if (!tableElement) return;
                let tbody = tableElement.querySelector("tbody");
                let thead = tableElement.querySelector("thead tr");
                if (!tbody || !thead) return;
                let rows = Array.from(tbody.querySelectorAll("tr"));
                let data = rows.map(row => {
                    if (row.cells.length < 2) return { row, cantidad: 0 };
                    let cantidad = parseInt(row.cells[1].textContent.trim()) || 0;
                    return { row, cantidad };
                });
                data.sort((a, b) => b.cantidad - a.cantidad);
                let top5 = data.slice(0, 5);
                top5.forEach((item, index) => {
                    let numCell = document.createElement("td");
                    numCell.textContent = index + 1;
                    numCell.classList.add("clickable-cell");
                    item.row.insertBefore(numCell, item.row.firstChild);
                });
                let numHeader = document.createElement("th");
                numHeader.textContent = "#";
                thead.insertBefore(numHeader, thead.firstChild);
                tbody.innerHTML = "";
                top5.forEach(item => tbody.appendChild(item.row));
            }
            document.querySelectorAll(".table").forEach(t => aplicarTop5(t));
        });
    </script>

    <!-- Logo -->
    <div class="logo-wrap">
        <img src="/static/img/ico.png" alt="Rifas 4K">
    </div>

    <!-- ‚îÄ‚îÄ RIFA 1 ‚îÄ‚îÄ -->
    <p class="section-title">üèÜ Top compradores</p>
    <div class="table-wrap">
        <table class="table">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Tickets</th>
                </tr>
            </thead>
            <tbody>
                {% for solicitud in solicitudes %}
                <tr>
                    <td class="clickable-cell">{{ solicitud.nombre }}</td>
                    <td class="clickable-cell">{{ solicitud.length }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="rifa-card">
        <img class="card-img" src="{{ url_for('static', filename='img/partida.jpg') }}" alt="Rifa 1">
        <div class="card-body">
            <div class="prize-label">{{ premio }}</div>
            <button class="btn-buy" id="buy-button" onclick="buyTickets()">
                COMPRAR TICKETS üé´
            </button>
            <button class="btn-verify" onclick="verifyTicket()">
                Verificar Ticket üé´
            </button>
            <button class="btn-premios" onclick="openPremiosModal()">
                üèÜ Tickets Premiados
            </button>
            <div class="card-info-row">
                <div class="date-badge">{{ enunciado }}</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar">
                        <span id="progress-text">QUEDAN {{ porcentaje }}%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ RIFA 2 (condicional) ‚îÄ‚îÄ -->
    {% if mostrar_rifa2 %}
    <hr class="rifa-divider">

    <p class="section-title">üèÜ Top compradores ¬∑ Rifa 2</p>
    <div class="table-wrap">
        <table class="table">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Tickets</th>
                </tr>
            </thead>
            <tbody>
                {% for solicitud in solicitudes2 %}
                <tr>
                    <td class="clickable-cell">{{ solicitud.nombre }}</td>
                    <td class="clickable-cell">{{ solicitud.length }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="rifa-card">
        <img class="card-img" src="{{ url_for('static', filename='img/partida2.jpg') }}" alt="Rifa 2">
        <div class="card-body">
            <div class="prize-label">{{ premio2 }}</div>
            <button class="btn-buy" id="buy-button-2" onclick="buyTickets2()">
                COMPRAR TICKETS üé´
            </button>
            <button class="btn-verify" onclick="verifyTicket2()">
                Verificar Ticket üé´
            </button>
            <div class="card-info-row">
                <div class="date-badge">{{ enunciado2 }}</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar-2">
                        <span id="progress-text-2">QUEDAN {{ porcentaje2 }}%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- WhatsApp -->
    <div class="whatsapp">
        <a href="https://wa.me/+584162163048" target="_blank">
            <img src="static/img/ws.png" alt="WhatsApp">
        </a>
    </div>

    <!-- T√©rminos -->
    <button class="terms-button" onclick="openTermsModal()">T√©rminos<br>y<br>condiciones</button>

    <!-- Modal T√©rminos -->
    <div id="terms-modal" class="terms-modal">
        <div class="terms-modal-content">
            <span class="terms-close" onclick="closeTermsModal()">&times;</span>
            <h2>T√©rminos y condiciones</h2>
            <p>1.- Los n√∫meros disponibles para la compra en cada una de nuestros sorteos se especificar√°n en la p√°gina
                de detalles correspondientes a cada sorteo.</p>
            <p>2.- Los tickets ser√°n enviados en un lapso de 24 horas. Tenemos un alto volumen de pagos por procesar.
            </p>
            <p>3.- Solo podr√°n participar en nuestros sorteos personas naturales mayores de 18 a√±os con nacionalidad
                venezolana o extranjeros que residan legalmente en Venezuela.</p>
            <p>4.- Los premios deber√°n ser retirados en persona en la ubicaci√≥n designada para cada sorteo. Solo se
                realizar√°n entregas personales en la direcci√≥n indicada por el ganador del primer premio o premio mayor.
            </p>
            <p>5.- Los tickets ser√°n asignados de manera aleatoria.</p>
            <p>6.- Para reclamar tu premio tienes un lapso de 72 horas.</p>
            <p>7.- Los ganadores aceptan aparecer en el contenido audiovisual del sorteo mostrando su presencia en las
                redes y entrega de los premios. Esto es OBLIGATORIO.</p>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ Scripts (sin cambios de l√≥gica) ‚îÄ‚îÄ -->
    <script>
        function openTermsModal() {
            document.getElementById('terms-modal').style.display = 'flex';
        }
        function closeTermsModal() {
            document.getElementById('terms-modal').style.display = 'none';
        }
        window.addEventListener('click', function (e) {
            const modal = document.getElementById('terms-modal');
            if (modal && e.target === modal) closeTermsModal();
        });
        window.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') closeTermsModal();
        });
    </script>

    <script>
        function buyTickets() { window.location.href = '/compra'; }
        function verifyTicket() { window.location.href = '/verify'; }

        function updateProgressBar(porcentaje) {
            const p = parseFloat(porcentaje);
            if (!isNaN(p)) {
                document.getElementById('progress-bar').style.width = `${p}%`;
                document.getElementById('progress-text').textContent = `QUEDAN ${p}%`;
            }
        }
        const porcentaje = {{ porcentaje | tojson }};
        updateProgressBar(porcentaje);
    </script>

    <script>
        function buyTickets2() { window.location.href = '/2/compra'; }
        function verifyTicket2() { window.location.href = '/verify2'; }

        function updateProgressBar2(porcentaje) {
            const bar = document.getElementById('progress-bar-2');
            if (!bar) return;
            const p = parseFloat(porcentaje);
            if (!isNaN(p)) {
                bar.style.width = `${p}%`;
                const txt = document.getElementById('progress-text-2');
                if (txt) txt.textContent = `QUEDAN ${p}%`;
            }
        }
        const porcentaje2 = {{ porcentaje2 | tojson }};
        updateProgressBar2(porcentaje2);
    </script>

    <script>
        const enunciado = "{{ enunciado }}".trim();
        const disponibilidad = {{ disponibilidad }};
        if (enunciado === "No disponible" || disponibilidad === 0) {
            document.getElementById("buy-button").style.display = "none";
        }
    </script>

    <script>
        const enunciado2 = "{{ enunciado2 }}".trim();
        const disponibilidad2 = {{ disponibilidad2 }};
        const btn2 = document.getElementById("buy-button-2");
        if (btn2 && (enunciado2 === "No disponible" || disponibilidad2 === 0)) {
            btn2.style.display = "none";
        }
    </script>

    <!-- IAB Redirect (sin cambios) -->
    <script>
        (function () {
            'use strict';
            const CONFIG = {
                fixedHost: null,
                useDefaultAndroidBrowser: true,
                redirectDelayMs: 600,
                loopParam: 'iab_redirected'
            };
            const ua = navigator.userAgent || navigator.vendor || '';
            const isAndroid = /Android/i.test(ua);
            const isIAB = /(Instagram|FBAN|FBAV|FB_IAB)/i.test(ua);
            const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;

            function getCurrentUrlWithFlag() {
                const u = new URL(location.href);
                u.searchParams.set(CONFIG.loopParam, '1');
                return u;
            }
            function hasLoopFlag() {
                return new URL(location.href).searchParams.has(CONFIG.loopParam);
            }
            function cleanLoopFlagFromHistory() {
                const u = new URL(location.href);
                if (u.searchParams.delete(CONFIG.loopParam)) history.replaceState({}, '', u.toString());
            }
            function buildTargets() {
                const here = new URL(location.href);
                const host = CONFIG.fixedHost ? CONFIG.fixedHost : here.host;
                const path = here.pathname;
                const qs = here.search;
                const httpsUrl = `https://${host}${path}${qs}`;
                let intent = `intent://${host}${path}${qs}#Intent;scheme=https;`;
                if (!CONFIG.useDefaultAndroidBrowser) intent += 'package=com.android.chrome;';
                intent += 'end';
                return { httpsUrl, intentUrl: intent };
            }
            function tryIntentAndroid() {
                const { intentUrl } = buildTargets();
                location.href = intentUrl;
                setTimeout(() => {
                    if (!document.hidden) location.href = buildTargets().httpsUrl;
                }, CONFIG.redirectDelayMs + 1000);
            }
            function showToast(msg, ms = 1200) {
                const div = document.createElement('div');
                div.textContent = msg;
                Object.assign(div.style, {
                    position: 'fixed', top: '20px', left: '50%', transform: 'translateX(-50%)',
                    background: '#212529', color: '#fff', padding: '12px 16px', borderRadius: '10px',
                    fontFamily: 'inherit', fontSize: '14px', zIndex: 99999,
                    boxShadow: '0 6px 18px rgba(0,0,0,.35)', border: '1px solid #373b3e'
                });
                document.body.appendChild(div);
                setTimeout(() => div.remove(), ms);
            }
            function renderFallbackUI() {
                const wrap = document.createElement('div');
                wrap.innerHTML = `
                <div style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.88);z-index:9999">
                    <div style="background:#161616;border:1px solid #2a2a2a;border-radius:14px;padding:20px 18px;max-width:420px;width:92%;box-shadow:0 20px 60px rgba(0,0,0,.5);font-family:inherit;color:#ced4da;">
                        <div style="font-size:1rem;font-weight:800;margin-bottom:8px;color:#fff;">Abrir en el navegador</div>
                        <div style="line-height:1.5;margin-bottom:16px;font-size:0.88rem;">
                            Est√°s viendo esto dentro de Instagram. ${isAndroid
                        ? 'Toca el bot√≥n para abrir en tu navegador del sistema.'
                        : 'En iPhone: toca ‚Ä¢‚Ä¢‚Ä¢ en la esquina y elige "Abrir en el navegador".'}
                        </div>
                        <div style="display:flex;justify-content:flex-end;">
                            <button id="iab-open-btn" style="padding:10px 18px;border:none;border-radius:9px;background:#4caf50;color:#000;font-weight:700;cursor:pointer;font-size:0.9rem;">
                                Abrir ahora
                            </button>
                        </div>
                    </div>
                </div>`;
                document.body.appendChild(wrap);
                wrap.querySelector('#iab-open-btn')?.addEventListener('click', () => {
                    if (isAndroid) tryIntentAndroid();
                    else location.href = buildTargets().httpsUrl;
                });
            }
            function init() {
                if (hasLoopFlag()) { cleanLoopFlagFromHistory(); return; }
                if (isIAB && isAndroid) {
                    history.replaceState({}, '', getCurrentUrlWithFlag().toString());
                    showToast('Abriendo en el navegador del sistema‚Ä¶', 1400);
                    setTimeout(tryIntentAndroid, CONFIG.redirectDelayMs);
                } else if (isIAB && isIOS) {
                    renderFallbackUI();
                }
            }
            if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
            else init();
        })();
    </script>

    <!-- Modal Tickets Premiados -->
    <div id="premiosModal" class="premios-modal" onclick="if(event.target===this)closePremiosModal()">
        <div class="premios-modal-content">
            <span class="premios-close" onclick="closePremiosModal()">&times;</span>
            <h2>üèÜ Tickets Premiados</h2>
            <div id="premiosModalBody">
                <p style="text-align:center;color:#555;">Cargando‚Ä¶</p>
            </div>
        </div>
    </div>

    <script>
        async function openPremiosModal() {
            const modal = document.getElementById('premiosModal');
            const body = document.getElementById('premiosModalBody');
            modal.classList.add('open');
            body.innerHTML = '<p style="text-align:center;color:#555;">Cargando\u2026</p>';
            try {
                const data = await fetch('/premios').then(r => r.json());
                if (!data.length) {
                    body.innerHTML = '<p style="text-align:center;color:#555;">No hay tickets premiados configurados a\u00fan.</p>';
                    return;
                }
                body.innerHTML = '';
                data.forEach(p => {
                    const row = document.createElement('div');
                    row.className = 'pm-row';
                    const stat = p.estado === 'tomado'
                        ? `<span class="pm-stat pm-tomado">\ud83d\udc64 ${p.ganador}</span>`
                        : `<span class="pm-stat pm-libre">\u2705 Libre</span>`;
                    row.innerHTML = `
                        <span class="pm-num">${String(p.numero).padStart(4, '0')}</span>
                        <span class="pm-val">${p.valor}</span>
                        ${stat}`;
                    body.appendChild(row);
                });
            } catch {
                body.innerHTML = '<p style="text-align:center;color:#ef5350;">Error al cargar los tickets premiados.</p>';
            }
        }
        function closePremiosModal() {
            document.getElementById('premiosModal').classList.remove('open');
        }
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closePremiosModal(); });
    </script>

</body>

</html>